<% if @group.students.blank? %>
	<h5>There are no members in this group.</h5>
	<%= link_to 'Add Member', new_group_student_path(@group), :class => 'button left minor margin_top' %>

<% else %>
	<ul id="student_list">
    <% for member in @group.students %>
    	<li>
			<span id="student_info_<%= member.id %>" class="formwrap list members" onClick="$(this).hide(); $('#edit_student_<%= member.id %>').show();">
			        <div id="student_name" class="student_name">
			        <span class="text_highlight josefin"><%= member.name %></span>
			        <%= link_to 'remove', group_path(@group, :group=>{:students_attributes=>[{:id=>member.id,:_destroy=>1}]}), :confirm => 'Are you sure?', :method => :put, :id => 'remove_member' %>
			    </div>
			    <div id="student_number">
			        <span class="text_highlight"><%= PhoneValidator::OUTPUT_PRINTF%member.phone_number.scan(/\d/) if member.phone_number.present? %></span>
			    </div>
			    <div id="student_email" class="student_email">
			      <span class="text_highlight"><%= member.email %></span>
			    </div>
			</span>
			<span id="edit_student_info_<%=member.id%>">
			    <%=render :partial => "groups/ajax_membership_form", :locals => {:student => member, :group => @group}%>
			</span>
    	</li>
    <% end %>
    <li>
      
      <%= nested_form_for @group, :url => create_multiple_group_students_path(@group), :html => {:method => :post} do |f|%>
        <% f.fields_for :students, [] do |sf| %>
          <%= sf.text_field :name, :class => "ajax_edit student", :title => "Name" %>
          <%= sf.text_field :phone_number, :class => "ajax_edit number infield_form_label", :title => "Mobile Number" %>
          <%= sf.text_field :email, :class=>"ajax_edit number infield_form_label", :title => "Email" %>
          <%= sf.link_to_remove "cancel"%>
        <% end %>
        <%= f.link_to_add "Add member", :students, :class => 'button minor left margin_top' %>
        <%= f.submit "Save", :class => "button" %>
      <% end %>
      
    </li>
    <br><br><br>
    <li>
      <%= form_for @group, :url=>bulk_upload_students_group_path(@group), :html=>{:method=>:post, :multipart=>true}  do |f| %>
        <div class="field">
          <%= label :upload, "Bulk Add Members (CSV)", :for=>"upload[csv]" %>
          <%= file_field :upload, :csv %>
        </div>
        <div class="actions">
          <%= f.submit "Upload CSV", :class => 'button minor left margin_top' %>
        </div>
      <%end%>
    </li>
  </ul>
<% end %>